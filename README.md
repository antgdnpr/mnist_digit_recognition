## Запуск
Основу программы составляют два файла: файл уже обученной нейросетевой модели _model.pth_ и файл собственно программы _prog.py_. Программа подгружает модель и использует её для распознавания нарисованной пользователем цифры. 

На компьютере уже должны быть установлены python-библиотеки _numpy_, _torch_, _pyglet_. Об установке этих пакетов под конкретную систему смотрите официальную информацию в сети. В моём случае установка совершалась командой _pip_, например:
```
pip install pyglet
``` 
Если нужные библиотеки установлены, то для запуска программы разместите файлы _model.pth_ и _prog.py_ в один каталог, затем используйте команду:
```
python3 prog.py
```

Скриншот работы программы:

![screen1](https://github.com/antgdnpr/mnist_digit_recognition/assets/154733297/7e7d5862-926c-4f37-9390-382f640fd1f1)

## Генерация файла модели
Файл _model.pth_ уже готов для использования, но изначально для его создания мной была написана программа _get_nn.py_ (код этой программы почти полностью основывается на материале небольшого курса "Introduction to PyTorch", с которым можно ознакомиться здесь: https://pytorch.org/tutorials/beginner/basics/intro.html). Программа _get_nn.py_ использует датасет MNIST для обучения полносвязной нейросети, после чего сохраняет натренированную модель в файле _tmp_model.pth_. 

Датасет MNIST доступен для скачивания по адресу http://yann.lecun.com/exdb/mnist/. Указанные там четыре сжатых бинарных файла _.gz_ следует скачать и поместить в отдельный каталог. Эти файлы нужно распаковать, затем удалить из них ненужные нам начальные байты (в которых содержится описание формата данных), после чего объединить их содержимое в два бинарных файла _images_ и _labels_, устранив этим разделение на train и test, которое создатели датасета зачем-то сделали за нас. Вся описанная в последнем предложении процедура делается следующими командами (они есть в файле _mnist_prepare.sh_):
```
gzip -d train-images-idx3-ubyte.gz
gzip -d t10k-images-idx3-ubyte.gz
gzip -d train-labels-idx1-ubyte.gz
gzip -d t10k-labels-idx1-ubyte.gz
dd iflag=skip_bytes skip=16 if=train-images-idx3-ubyte > images1
dd iflag=skip_bytes skip=16 if=t10k-images-idx3-ubyte > images2
dd iflag=skip_bytes skip=8 if=train-labels-idx1-ubyte > labels1
dd iflag=skip_bytes skip=8 if=t10k-labels-idx1-ubyte > labels2
cat images1 images2 > images
cat labels1 labels2 > labels
rm images1 images2 labels1 labels2
```
Путь к каталогу с файлами _images_ и _labels_ следует внести в переменную _where_data_ в коде программы _get_nn.py_. 

Возвращаемся в каталог с файлами программы. Команда
```
python3 get_nn.py
```
создаст файл _tmp_model.pth_, который можно использовать вместо _model.pth_ в программе _prog.py_.

## Модель _model.pth_
Модель _model.pth_ использует полносвязную нейросеть с двумя внутренними слоями размера 64. В качестве функции активации используется ReLU. Для регуляризации обучения используется Dropout. Архитектуру модели можно увидеть в коде класса _MyNN_ в файле _get_nn.py_.

Accuracy для модели _model.pth_ составляет на тестовой выборке 97.9%.

Можно обратить внимание, что программа плохо распознаёт нарисованные цифры "8", "0", а также плохо распознаёт любую цифру, нарисованную на периферии окна. 
